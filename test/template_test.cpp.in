#include <iostream>
#include <sstream>
#include <fstream>
#include <list>

int main(int argc, char ** argv)
{
	std::cout << "try compile @_test_name@" << std::endl;
	
	if (@result@)
	{
		std::ifstream errorFile("@_error_file@");
		//std::ifstream expected("@_expected_error@");
		
		std::istringstream expected("@expected_error@");
		std::list<std::string> listError;
		
		std::string str;
		
		while (std::getline(expected, str, ';'))
		{
			listError.push_front(str);
		}
			
		std::list<std::string>::iterator it;	
		
		while (std::getline(errorFile, str))
		{
			if (str.find("error:") != std::string::npos /*|| str.find("warning:") != std::string::npos*/)
			{
				it = listError.begin();
				
				//std::cout << str << std::endl;
				
				while(it != listError.end() && str.find(*it) == std::string::npos)
				{
					++it;
				}
					
				// if not expected error
				if (it == listError.end())
				{
					std::cout << "UNKNOWN ERROR FOUND in " << str << std::endl;
					return listError.size()?1:0;
				}
				else
				{
					std::cout << "EXPECTED ERROR FOUND" << std::endl;
				}
			}
		}
		
		return @_expected_result@?1:0;
	}
	
	std::cout << "NO ERROR FOUND" << std::endl;
	
	return @_expected_result@?0:1;
}

